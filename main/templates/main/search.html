{% extends "main/home.html" %}

{% block content %}

<div id = "summary">
	<form method="GET">{% csrf_token %}
	    Enter your search here: <input type="text" name="search"> <input type="submit" value="Search" />
	</form><br/><br/>

	{% if foundwine %}
	<div id = "temp2">
			<!-- <form method="POST" class="usrform">{% csrf_token %} -->
					<table id = "wines" form="usrform">
						<tr>
							<td>Request</td>
							<td>Variety</td>
							<td>AVA</td>
							<td>Inventory</td>
							<td>Units</td>
							<td>Lot</td>
							<td>Comments</td>

						</tr>

					{% for wine in foundwine %}
						<tr>
						    <td><input id= {{ wine.lot }} name="check" type="checkbox" 
						    	value= {{wine.lot}} ></td>
						    <td>{{ wine.variety}}</td>
						    <td>{{ wine.ava }}</td>
						    <td>{{ wine.current }}</td>
						    <td>{{ wine.units  }}</td>
						    <td>{{ wine.lot }}</td>
						    <td>{{ wine.comments }}</td>
						</tr>
					{% endfor %}
				</table>
				<input class="btn" type="submit" value="Request Selected Items" onclick="obtainSelection()"> 
			<!-- </form> -->
		</div>
	{% else%}
	<p> Item not found </p>

	{%endif%}

</div>
	<div id = "request">
			
		    <form method="POST" class="usrform" onsubmit ="return alert('Thank you! Someone will contact you within 2 business days. We look forward to working with you! -California Wine Classics Team'); " >{% csrf_token %}
		            {% for field in form %}
			            {% if field.name == 'name' %}
			            <label> Name: <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'last_name' %}
			            <label> Last Name: <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'email' %}
			            <label> Email: <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'phone' %}
			            <label> Phone Number: <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'address1' %}
			            <label> Address 1: <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'address2' %}
			            <label> Address 2: </label><br>
			            {{field}} <br>
			            {% elif field.name == 'city' %}
			            <label> City: <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'state' %}
			            <label> State: <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'zipcode' %}
			            <label> Zipcode: <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'country' %}
			            <label> Country: <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'single' %}
			            <label> I am a(n): <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {% elif field.name == 'looking' %}
			            <label> Tell us a little more about what you're looking for: </label><br>
			            {{field}} <br>
			            {% elif field.name == 'hear' %}
			            <label> How did you hear about us? <span style="color: red">*</span></label><br>
			            {{field}} <br>
			            {% else %}
			            <label> I am interested in : <span style="color: red">*</span> </label><br>
			            {{field}} <br>
			            {%endif%}

    				{% endfor %}


				   	<label>You've requested:</label>
				   	<table id = "requested" form="usrform">

			   		</table>

			    <input class="btn" type="submit">
			</form>
			
	</div>
{% endblock %}
			{%block footer%}
						<div id="tertiary" class = "widget-area widget-area--footer" role="complementary" itemscope>
				<div class="block-grid block-grid-3">
					<div id ="text-3" class = "widget widget_text block-grid-item">
						<h4 class="widget-title"> <a href = "/contact"> Contact Info </a> </h4>
						<div class="textwidget">
				<!-- 			<p> -->
								Phone: +1 (209) 727-0396<br>
								Fax: +1 (209) 727-0391<br>
								<a href = "/team"> Robert Indelicato </a> <br>
								<a href="mailto:robert@californiawineclassics.com">robert@californiawineclassics.com </a><br>
								<a href = "/leslie"> Leslie Bloudoff </a><br>
								<a href="mailto:leslie@californiawineclassics.com">leslie@californiawineclassics.com </a><br>

<!-- 							</p> -->
						</div>
					</div>
					<div id ="text-3" class = "widget widget_text block-grid-item">
						<h4 class="widget-title"> <a href="/winery" > Location </a> </h4>
						<div class="textwidget">
							<!-- <p> -->
								<h4 class="widget-title"> Address</h4>
								27 Locust Street  <br>
								Lodi, CA 95240<br>
								USA<br>
								<h4 class="widget-title"> Mailing Address</h4>
								PO Box 1088<br>
								Lodi, CA 95241<br>

							<!-- </p> -->
						</div>
						<h4 class="widget-title"> Hours</h4>
						<div class="textwidget">
							<!-- <p> -->
								8 a.m. - 5 p.m. PST, USA
							<!-- </p> -->
						</div>
					</div>
					<div id ="text-3" class = "widget widget_text block-grid-item">
						<h4 class="widget-title"> <a href="/news"> What's New </a></h4>
						<ul>
						<li>
							<a target="_blank" href = "https://twitter.com/CAWineClassics?lang=en">
							<img width="50" height="50" src="static/img/tweet.jpg" style="border:1px solid black; border-radius: 10px;">
							</a>
						</li>
						<li>
							<a target="_blank" href = "https://www.instagram.com/cawineclassics/">
								<img width="80" height="80" src="static/img/ig.jpg" >
							</a>
						</li>
						<li>
							<a target="_blank" href = "https://www.facebook.com/CAWineClassics">
								<img width="50" height="50" src="static/img/facebookicon.png" style="margin-right: 10px">
							</a>
						</li>
						<li>
							<a target="_blank" href = "https://www.linkedin.com/company/california-wine-classics">
								<img width="50" height="50" src="static/img/linkedin.jpg" >
							</a>
						</li>
						</ul>
					</div>

				</div>


			</div>
					<div class="google-maps">
			<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15413.020624260733!2d-121.28128738279095!3d38.136994452224!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x809aa01886eabfa9%3A0x7dca5d30ea19c158!2s27+Locust+St%2C+Lodi%2C+CA+95240!5e0!3m2!1sen!2sus!4v1507323106892&key=AIzaSyCTp6jz2iIz09wTWvMxMKTco5oEAdtWmn4" width="600" height="450" frameborder="0" style="border:0" ></iframe>

		</div>


			{%endblock%}


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script >
{%block script%}
//jquery to deal with row highlighting
$(function(){
    $("input[type='checkbox']").on('change', function() {
        $(this).closest('tr').toggleClass("highlight", this.checked);
    });
});

var masterList = [];


function obtainSelection()
{
	document.getElementById("request").style.display = "block"; 
	document.getElementById("summary").style.display = "none"; 
	var url = window.location.origin;
	checkboxes = document.getElementsByTagName("input"); 

	
	for (var i = 0; i < checkboxes.length; i++) {
	    var checkbox = checkboxes[i];

	    console.log(checkbox.checked);

	    var temp = [];

	    if (checkbox.checked == true)
	    {
	    	var currentRow = checkbox.parentNode.parentNode;
	    	console.log(currentRow);
	    	
	    	temp.push(currentRow);
	    	masterList.push(temp)
	    }

	} 

	
	renderSelection(masterList);


}

function renderSelection(masterList)
{

	var requested = document.getElementById("requested")


	console.log(masterList);
	console.log(masterList.length);


	for(var count =0; count < masterList.length; count++)
	{

		var row = requested.insertRow(count);
		console.log(masterList[count][0]);


		// row = masterList[count].innerHTML;
		var tdList = masterList[count][0].getElementsByTagName("td");
		console.log(tdList);
		console.log(tdList.length);
		
		for (var num = 0; num < tdList.length; num++)
		{
			var col = row.insertCell(num);
			console.log(tdList[num]);
			col.innerHTML = tdList[num].innerHTML;
		}
	}
	return true;
}
{%endblock%}
</script>